import json
import requests_with_caching

def get_movies_from_tastedive(s1):
    url = 'https://tastedive.com/api/similar'
    p = {}
    p['q'] = s1
    p['type'] = 'movies'
    p['limit'] = 5
    movie = requests_with_caching.get(url,params = p)
    movie_resp = movie.json()
    return movie_resp

def extract_movie_titles(f1):
    lst = []
    title_movies = f1['Similar']['Results']
    for title_movie in title_movies :
        lst.append(title_movie['Name'])    
    return lst

def get_related_titles(l1):
    lst = []
    for i in l1:
        f1 = get_movies_from_tastedive(i)
        f2 = extract_movie_titles(f1)
        for i2 in f2:
            if i2 not in lst:
                lst.append(i2)
    print(lst)
    return(lst)
# some invocations that we use in the automated tests; uncomment these if you are getting errors and want better error messages
get_related_titles(["Black Panther", "Captain Marvel"])
get_related_titles([])


